<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>ПредиктГруп. Интеграция с SAP ERP. Реализация мобильного прайс-чекера в магазине</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <link rel="stylesheet" href="bootstrap.css" media="screen">
    <link rel="stylesheet" href="assets/css/custom.min.css">
    <link rel="icon" href="img/pm_logo.png">
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-131511447-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-131511447-1');
    </script> 
  </head>
  <body>
    <div class="navbar navbar-expand-lg fixed-top navbar-light bg-light">
      <div class="container">
        <a href="../" class="navbar-brand"><img alt="PredicGroup" src="img/predictgroup.png" height="50px"></a>
	    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarColor03" aria-controls="navbarColor03" aria-expanded="false" aria-label="Toggle navigation">
	    	<span class="navbar-toggler-icon"></span>
	  	</button>
        <div class="collapse navbar-collapse" id="navbarResponsive">
          <ul class="navbar-nav">
            <li class="nav-item">
              <a class="nav-link" href="predictfx.html">PredictFX Графики </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="olap1cerp.html">OLAP 1С:ERP </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="sap.html">Интеграция SAP </a>
            </li>            
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" data-toggle="dropdown" href="#" id="download">Поддержка <span class="caret"></span></a>
              <div class="dropdown-menu" aria-labelledby="download">
                <a class="dropdown-item" href="support.html">Поддержка</a>
                <div class="dropdown-divider"></div>
                <a class="dropdown-item" href="https://github.com/predictgroup">Исходные коды программ</a>
                <a class="dropdown-item" href="documents.html">Документация</a>
                <div class="dropdown-divider"></div>
                <a class="dropdown-item" href="contacts.html">Контакты</a>
              </div>
            </li>
          </ul>


        </div>
      </div>
    </div>


    <div class="container">


      <!-- Containers
      ================================================== -->

      <ol class="breadcrumb">
        <li class="breadcrumb-item"><a href="index.html">Home</a></li>
        <li class="breadcrumb-item"><a href="sap.html">Интеграция SAP</a></li>        
        <li class="breadcrumb-item active">Реализация мобильного прайс-чекера в магазине</li>
      </ol>


      <!-- News -->
      <div class="bs-docs-section">

        <div class="row">
          <div class="col-lg-12">
            <span class="badge badge-primary">08 апреля 2019</span>
            <span class="badge badge-secondary">Интеграция с SAP ERP</span>
          </div>
        </div>

	    <div class="row">

          <div class="col-lg-12">

            <h4>Интеграция с SAP ERP. Реализация мобильного прайс-чекера в магазине.</h4>
            <p>В рассматриваемом нами примере интеграции SAP ERP со сторонним ПО мы будем использовать <a href="https://support.sap.com/en/product/connectors/msnet.html">SAP Connector for Microsoft .NET</a> для получения данных из SAP ERP. Программное обеспечение для терминала сбора данных (ТСД) будет состоять из Microsotf Internet Information Server (IIS) на сервере и клиентского ПО Internet Explorer, технология используемая для разработки компоненты - asp.net на языке программирования C#.</p>
            <p>При разработке FM в SAP указываем настройку "Дистанционный модуль"</p>
            <p><img src="img/sap_fm_settings.png"></p>
            <p>Функция принимает значение завод I_WERKS и возвращает таблицу TAB</p>
            <blockquote><ol><li><font color="#993333">FUNCTION</font>&nbsp;Y_GET_MATNR_PRICE</li><li>&nbsp;&nbsp;IMPORTING</li><li>&nbsp;&nbsp;&nbsp;&nbsp;<font color="#993333">VALUE</font><font color="#66cc66">&#40;</font>I_WERKS<font color="#66cc66">&#41;</font>&nbsp;<font color="#993333">TYPE</font>&nbsp;WERKS_D</li><li>&nbsp;&nbsp;TABLES</li><li>&nbsp;&nbsp;&nbsp;&nbsp;TAB&nbsp;<font color="#993333">LIKE</font>&nbsp;YSOUT_PRICE</li><li>&nbsp;&nbsp;EXCEPTIONS</li><li>&nbsp;&nbsp;&nbsp;&nbsp;NO_DATA</li><li>&nbsp;&nbsp;&nbsp;&nbsp;NO_VKORG.</li></ol></blockquote>

            <p>Настройка для IIS в базе данных SQL Server</p>
            <p><img src="img/SQL_settings.png"></p>

            <p>asp.net часть на C# используем SAP Connector for Microsoft .NET</p>

            <p>Настройка SAP Connector</p>

            <blockquote><ol><li>&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0600FF">public</font>&nbsp;<font color="#6666cc">class</font>&nbsp;MyBackendConfig&nbsp;<font color="#008000">:</font>&nbsp;IDestinationConfiguration</li><li>&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000">&#123;</font></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SaalutDataClasses1DataContext&nbsp;context<font color="#008000">;</font></li><li>&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0600FF">public</font>&nbsp;RfcConfigParameters&nbsp;GetParameters<font color="#008000">&#40;</font><font color="#6666cc">String</font>&nbsp;destinationName<font color="#008000">&#41;</font></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000">&#123;</font></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0600FF">if</font>&nbsp;<font color="#008000">&#40;</font>context&nbsp;<font color="#008000">==</font>&nbsp;<font color="#0600FF">null</font><font color="#008000">&#41;</font></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;context&nbsp;<font color="#008000">=</font>&nbsp;<font color="#008000">new</font>&nbsp;SaalutDataClasses1DataContext<font color="#008000">&#40;</font><font color="#008000">&#41;</font><font color="#008000">;</font></li><li>&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0600FF">if</font>&nbsp;<font color="#008000">&#40;</font><font color="#666666">&quot;AEP&quot;</font><font color="#008000">.</font><font color="#0000FF">Equals</font><font color="#008000">&#40;</font>destinationName<font color="#008000">&#41;</font><font color="#008000">&#41;</font></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000">&#123;</font></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0600FF">var</font>&nbsp;settingsSP&nbsp;<font color="#008000">=</font>&nbsp;<font color="#008000">&#40;</font><font color="#0600FF">from</font>&nbsp;s&nbsp;<font color="#0600FF">in</font>&nbsp;context<font color="#008000">.</font><font color="#0000FF">SettingsSAPERPTbls</font></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0600FF">select</font>&nbsp;s<font color="#008000">&#41;</font><font color="#008000">.</font><font color="#0000FF">FirstOrDefault</font><font color="#008000">&#40;</font><font color="#008000">&#41;</font><font color="#008000">;</font></li><li>&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RfcConfigParameters&nbsp;parms&nbsp;<font color="#008000">=</font>&nbsp;<font color="#008000">new</font>&nbsp;RfcConfigParameters<font color="#008000">&#40;</font><font color="#008000">&#41;</font><font color="#008000">;</font></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;parms<font color="#008000">.</font><font color="#0600FF">Add</font><font color="#008000">&#40;</font>RfcConfigParameters<font color="#008000">.</font><font color="#0000FF">Name</font>,&nbsp;settingsSP<font color="#008000">.</font><font color="#0000FF">SystemID</font><font color="#008000">&#41;</font><font color="#008000">;</font></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;parms<font color="#008000">.</font><font color="#0600FF">Add</font><font color="#008000">&#40;</font>RfcConfigParameters<font color="#008000">.</font><font color="#0000FF">AppServerHost</font>,&nbsp;settingsSP<font color="#008000">.</font><font color="#0000FF">MessageServerHost</font><font color="#008000">&#41;</font><font color="#008000">;</font></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0600FF">if</font>&nbsp;<font color="#008000">&#40;</font>settingsSP<font color="#008000">.</font><font color="#0000FF">LogonGroup</font>&nbsp;<font color="#008000">!=</font>&nbsp;<font color="#0600FF">null</font>&nbsp;<font color="#008000">||</font>&nbsp;settingsSP<font color="#008000">.</font><font color="#0000FF">LogonGroup</font>&nbsp;<font color="#008000">!=</font>&nbsp;<font color="#666666">&quot;&quot;</font><font color="#008000">&#41;</font></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;parms<font color="#008000">.</font><font color="#0600FF">Add</font><font color="#008000">&#40;</font>RfcConfigParameters<font color="#008000">.</font><font color="#0000FF">LogonGroup</font>,&nbsp;settingsSP<font color="#008000">.</font><font color="#0000FF">LogonGroup</font><font color="#008000">&#41;</font><font color="#008000">;</font></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;parms<font color="#008000">.</font><font color="#0600FF">Add</font><font color="#008000">&#40;</font>RfcConfigParameters<font color="#008000">.</font><font color="#0000FF">SystemID</font>,&nbsp;settingsSP<font color="#008000">.</font><font color="#0000FF">SystemID</font><font color="#008000">&#41;</font><font color="#008000">;</font></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;parms<font color="#008000">.</font><font color="#0600FF">Add</font><font color="#008000">&#40;</font>RfcConfigParameters<font color="#008000">.</font><font color="#0000FF">SystemNumber</font>,&nbsp;settingsSP<font color="#008000">.</font><font color="#0000FF">SystemNumber</font><font color="#008000">&#41;</font><font color="#008000">;</font></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0600FF">if</font>&nbsp;<font color="#008000">&#40;</font>settingsSP<font color="#008000">.</font><font color="#0000FF">SAPRouter</font>&nbsp;<font color="#008000">!=</font>&nbsp;<font color="#0600FF">null</font>&nbsp;<font color="#008000">||</font>&nbsp;settingsSP<font color="#008000">.</font><font color="#0000FF">SAPRouter</font>&nbsp;<font color="#008000">!=</font>&nbsp;<font color="#666666">&quot;&quot;</font><font color="#008000">&#41;</font></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;parms<font color="#008000">.</font><font color="#0600FF">Add</font><font color="#008000">&#40;</font>RfcConfigParameters<font color="#008000">.</font><font color="#0000FF">SAPRouter</font>,&nbsp;settingsSP<font color="#008000">.</font><font color="#0000FF">SAPRouter</font><font color="#008000">&#41;</font><font color="#008000">;</font></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;parms<font color="#008000">.</font><font color="#0600FF">Add</font><font color="#008000">&#40;</font>RfcConfigParameters<font color="#008000">.</font><font color="#0000FF">User</font>,&nbsp;settingsSP<font color="#008000">.</font><font color="#0000FF">SAPUser</font><font color="#008000">&#41;</font><font color="#008000">;</font></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;parms<font color="#008000">.</font><font color="#0600FF">Add</font><font color="#008000">&#40;</font>RfcConfigParameters<font color="#008000">.</font><font color="#0000FF">Password</font>,&nbsp;settingsSP<font color="#008000">.</font><font color="#0000FF">SAPPassword</font><font color="#008000">&#41;</font><font color="#008000">;</font></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;parms<font color="#008000">.</font><font color="#0600FF">Add</font><font color="#008000">&#40;</font>RfcConfigParameters<font color="#008000">.</font><font color="#0000FF">Client</font>,&nbsp;settingsSP<font color="#008000">.</font><font color="#0000FF">Client</font><font color="#008000">&#41;</font><font color="#008000">;</font></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;parms<font color="#008000">.</font><font color="#0600FF">Add</font><font color="#008000">&#40;</font>RfcConfigParameters<font color="#008000">.</font><font color="#0000FF">Language</font>,&nbsp;<font color="#666666">&quot;en&quot;</font><font color="#008000">&#41;</font><font color="#008000">;</font></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;parms<font color="#008000">.</font><font color="#0600FF">Add</font><font color="#008000">&#40;</font>RfcConfigParameters<font color="#008000">.</font><font color="#0000FF">PoolSize</font>,&nbsp;<font color="#666666">&quot;5&quot;</font><font color="#008000">&#41;</font><font color="#008000">;</font></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;parms<font color="#008000">.</font><font color="#0600FF">Add</font><font color="#008000">&#40;</font>RfcConfigParameters<font color="#008000">.</font><font color="#0000FF">MaxPoolSize</font>,&nbsp;<font color="#666666">&quot;10&quot;</font><font color="#008000">&#41;</font><font color="#008000">;</font></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;parms<font color="#008000">.</font><font color="#0600FF">Add</font><font color="#008000">&#40;</font>RfcConfigParameters<font color="#008000">.</font><font color="#0000FF">IdleTimeout</font>,&nbsp;<font color="#666666">&quot;600&quot;</font><font color="#008000">&#41;</font><font color="#008000">;</font></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0600FF">return</font>&nbsp;parms<font color="#008000">;</font></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000">&#125;</font></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0600FF">else</font>&nbsp;<font color="#0600FF">return</font>&nbsp;<font color="#0600FF">null</font><font color="#008000">;</font></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000">&#125;</font></li><li>&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0600FF">public</font>&nbsp;<font color="#6666cc">bool</font>&nbsp;ChangeEventsSupported<font color="#008000">&#40;</font><font color="#008000">&#41;</font></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000">&#123;</font>&nbsp;<font color="#0600FF">return</font>&nbsp;<font color="#0600FF">false</font><font color="#008000">;</font>&nbsp;<font color="#008000">&#125;</font></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0600FF">public</font>&nbsp;<font color="#0600FF">event</font>&nbsp;RfcDestinationManager<font color="#008000">.</font><font color="#0000FF">ConfigurationChangeHandler</font>&nbsp;ConfigurationChanged<font color="#008000">;</font></li><li>&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000">&#125;</font></li></ol></blockquote>

            <p>Загрузка данных:</p>

            <blockquote><ol><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RfcDestinationManager<font color="#008000">.</font><font color="#0000FF">RegisterDestinationConfiguration</font><font color="#008000">&#40;</font>cfg<font color="#008000">&#41;</font><font color="#008000">;</font><font color="#008080">//1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RfcDestination&nbsp;prd&nbsp;<font color="#008000">=</font>&nbsp;RfcDestinationManager<font color="#008000">.</font><font color="#0000FF">GetDestination</font><font color="#008000">&#40;</font><font color="#666666">&quot;AEP&quot;</font><font color="#008000">&#41;</font><font color="#008000">;</font><font color="#008080">//2&nbsp;&nbsp;</font></li><li>&nbsp;</li><li>&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RfcRepository&nbsp;repo&nbsp;<font color="#008000">=</font>&nbsp;prd<font color="#008000">.</font><font color="#0000FF">Repository</font><font color="#008000">;</font><font color="#008080">//3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IRfcFunction&nbsp;pricesBapi&nbsp;<font color="#008000">=</font></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;repo<font color="#008000">.</font><font color="#0000FF">CreateFunction</font><font color="#008000">&#40;</font><font color="#666666">&quot;Y_GET_MATNR_PRICE&quot;</font><font color="#008000">&#41;</font><font color="#008000">;</font><font color="#008080">//4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pricesBapi<font color="#008000">.</font><font color="#0000FF">SetValue</font><font color="#008000">&#40;</font><font color="#666666">&quot;I_WERKS&quot;</font>,&nbsp;werk<font color="#008000">&#41;</font><font color="#008000">;</font>&nbsp;<font color="#008080">//5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pricesBapi<font color="#008000">.</font><font color="#0000FF">Invoke</font><font color="#008000">&#40;</font>prd<font color="#008000">&#41;</font><font color="#008000">;</font>&nbsp;<font color="#008080">//6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IRfcTable&nbsp;detail&nbsp;<font color="#008000">=</font>&nbsp;pricesBapi<font color="#008000">.</font><font color="#0000FF">GetTable</font><font color="#008000">&#40;</font><font color="#666666">&quot;TAB&quot;</font><font color="#008000">&#41;</font><font color="#008000">;</font></li></ol></blockquote>

            <p>Полученные данные вставляем в таблицу SQL Server:</p>

            <blockquote><ol><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#6666cc">int</font>&nbsp;i&nbsp;<font color="#008000">=</font>&nbsp;<font color="#FF0000">0</font><font color="#008000">;</font></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0600FF">foreach</font>&nbsp;<font color="#008000">&#40;</font>IRfcStructure&nbsp;elem&nbsp;<font color="#0600FF">in</font>&nbsp;detail<font color="#008000">&#41;</font></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000">&#123;</font></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#6666cc">string</font>&nbsp;matnr&nbsp;<font color="#008000">=</font>&nbsp;elem<font color="#008000">&#91;</font><font color="#FF0000">0</font><font color="#008000">&#93;</font><font color="#008000">.</font><font color="#0000FF">GetString</font><font color="#008000">&#40;</font><font color="#008000">&#41;</font><font color="#008000">;</font></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#6666cc">double</font>&nbsp;kbetr&nbsp;<font color="#008000">=</font>&nbsp;elem<font color="#008000">&#91;</font><font color="#FF0000">1</font><font color="#008000">&#93;</font><font color="#008000">.</font><font color="#0000FF">GetDouble</font><font color="#008000">&#40;</font><font color="#008000">&#41;</font><font color="#008000">;</font></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#6666cc">string</font>&nbsp;kschl&nbsp;<font color="#008000">=</font>&nbsp;elem<font color="#008000">&#91;</font><font color="#FF0000">2</font><font color="#008000">&#93;</font><font color="#008000">.</font><font color="#0000FF">GetString</font><font color="#008000">&#40;</font><font color="#008000">&#41;</font><font color="#008000">;</font></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#6666cc">string</font>&nbsp;assort&nbsp;<font color="#008000">=</font>&nbsp;elem<font color="#008000">&#91;</font><font color="#FF0000">3</font><font color="#008000">&#93;</font><font color="#008000">.</font><font color="#0000FF">GetString</font><font color="#008000">&#40;</font><font color="#008000">&#41;</font><font color="#008000">;</font></li><li>&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SAPPriceTbl&nbsp;np&nbsp;<font color="#008000">=</font>&nbsp;<font color="#008000">new</font>&nbsp;SAPPriceTbl<font color="#008000">&#40;</font><font color="#008000">&#41;</font><font color="#008000">;</font></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;np<font color="#008000">.</font><font color="#0000FF">MATNR</font>&nbsp;<font color="#008000">=</font>&nbsp;matnr<font color="#008000">;</font></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;np<font color="#008000">.</font><font color="#0000FF">KBETR</font>&nbsp;<font color="#008000">=</font>&nbsp;kbetr<font color="#008000">;</font></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;np<font color="#008000">.</font><font color="#0000FF">KSCHL</font>&nbsp;<font color="#008000">=</font>&nbsp;kschl<font color="#008000">;</font></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;np<font color="#008000">.</font><font color="#0000FF">ASSORT</font>&nbsp;<font color="#008000">=</font>&nbsp;assort<font color="#008000">;</font></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;context<font color="#008000">.</font><font color="#0000FF">SAPPriceTbls</font><font color="#008000">.</font><font color="#0000FF">InsertOnSubmit</font><font color="#008000">&#40;</font>np<font color="#008000">&#41;</font><font color="#008000">;</font></li><li>&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0600FF">if</font>&nbsp;<font color="#008000">&#40;</font>i&nbsp;<font color="#008000">==</font>&nbsp;<font color="#FF0000">100</font><font color="#008000">&#41;</font></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000">&#123;</font></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;context<font color="#008000">.</font><font color="#0000FF">SubmitChanges</font><font color="#008000">&#40;</font><font color="#008000">&#41;</font><font color="#008000">;</font></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i&nbsp;<font color="#008000">=</font>&nbsp;<font color="#FF0000">0</font><font color="#008000">;</font></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000">&#125;</font></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i<font color="#008000">++;</font></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000">&#125;</font></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;context<font color="#008000">.</font><font color="#0000FF">SubmitChanges</font><font color="#008000">&#40;</font><font color="#008000">&#41;</font><font color="#008000">;</font></li></ol></blockquote>

            <p>Рисуем интерфейс в Visual Studio для ТСД. Осуществляем поиск по штрихкоду, визуально сопостовляем цену в ТСД с ценой на ценнике и в случае расхождений добавляем в журнал:</p>
            <p><img src="img/interface_tsd.png"></p>            

            <p>Полный код C# <a href="https://github.com/PredictGroup/SAALUT/blob/master/Saalut/UKM_SAPERP_CheckPrices.aspx.cs">на GitHub</a></p>
            <p>Полный код функционального модуля SAP в качестве примера:</p>
            <blockquote><ol><li><font color="#993333">FUNCTION</font>&nbsp;Y_GET_MATNR_PRICE</li><li>&nbsp;&nbsp;IMPORTING</li><li>&nbsp;&nbsp;&nbsp;&nbsp;<font color="#993333">VALUE</font><font color="#66cc66">&#40;</font>I_WERKS<font color="#66cc66">&#41;</font>&nbsp;<font color="#993333">TYPE</font>&nbsp;WERKS_D</li><li>&nbsp;&nbsp;TABLES</li><li>&nbsp;&nbsp;&nbsp;&nbsp;TAB&nbsp;<font color="#993333">LIKE</font>&nbsp;YSOUT_PRICE</li><li>&nbsp;&nbsp;EXCEPTIONS</li><li>&nbsp;&nbsp;&nbsp;&nbsp;NO_DATA</li><li>&nbsp;&nbsp;&nbsp;&nbsp;NO_VKORG.</li><li>&nbsp;</li><li>&nbsp;</li><li>&nbsp;&nbsp;DATA:&nbsp;lv_vkorg&nbsp;<font color="#993333">TYPE</font>&nbsp;vkorg<font color="#66cc66">,</font></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lt_rec&nbsp;<font color="#993333">TYPE</font>&nbsp;<font color="#993333">TABLE</font>&nbsp;<font color="#993333">OF</font>&nbsp;t_line<font color="#66cc66">,</font></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_rec&nbsp;<font color="#993333">TYPE</font>&nbsp;t_line<font color="#66cc66">,</font></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lr_kschl&nbsp;<font color="#993333">TYPE</font>&nbsp;ycl_common<font color="#66cc66">=&gt;</font>ty_t_kschl_range.</li><li>&nbsp;</li><li>&nbsp;&nbsp;<font color="#993333">SELECT</font>&nbsp;SINGLE&nbsp;vkorg&nbsp;<font color="#993333">FROM</font>&nbsp;t001w</li><li>&nbsp;&nbsp;&nbsp;&nbsp;<font color="#993333">INTO</font>&nbsp;lv_vkorg</li><li>&nbsp;&nbsp;&nbsp;&nbsp;<font color="#993333">WHERE</font>&nbsp;werks&nbsp;EQ&nbsp;i_werks.</li><li>&nbsp;&nbsp;<font color="#993333">IF</font>&nbsp;sy<font color="#66cc66">-</font>subrc&nbsp;NE&nbsp;<font color="#cc66cc">0</font>&nbsp;<font color="#993333">OR</font>&nbsp;lv_vkorg&nbsp;<font color="#993333">IS</font>&nbsp;<font color="#993333">INITIAL</font>.</li><li>&nbsp;&nbsp;&nbsp;&nbsp;<font color="#993333">RAISE</font>&nbsp;no_vkorg.</li><li>&nbsp;&nbsp;ENDIF.</li><li>&nbsp;</li><li>&nbsp;&nbsp;lr_kschl&nbsp;<font color="#66cc66">=</font>&nbsp;ycl_common<font color="#66cc66">=&gt;</font>get_kschl_range<font color="#66cc66">&#40;</font>&nbsp;iv_call_prog&nbsp;<font color="#66cc66">=</font>&nbsp;sy<font color="#66cc66">-</font>repid&nbsp;iv_call_index&nbsp;<font color="#66cc66">=</font>&nbsp;<font color="#cc66cc">1</font>&nbsp;<font color="#66cc66">&#41;</font>.</li><li>&nbsp;</li><li>&nbsp;&nbsp;<font color="#993333">IF</font>&nbsp;tab<font color="#66cc66">&#91;</font><font color="#66cc66">&#93;</font>&nbsp;<font color="#993333">IS</font>&nbsp;<font color="#993333">INITIAL</font>.</li><li>&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;<font color="#993333">SELECT</font>&nbsp;a971~kschl&nbsp;a971~matnr&nbsp;a971~vrkme&nbsp;a971~datbi&nbsp;a971~datab&nbsp;a971~knumh</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;konp~kopos&nbsp;konp~kbetr&nbsp;konp~konwa&nbsp;<font color="#993333">AS</font>&nbsp;waers&nbsp;konp~loevm_ko</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#993333">INTO</font>&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;<font color="#993333">OF</font>&nbsp;<font color="#993333">TABLE</font>&nbsp;lt_rec</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#993333">FROM</font>&nbsp;a971&nbsp;INNER&nbsp;JOIN&nbsp;mara</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#993333">ON</font>&nbsp;mara~matnr&nbsp;<font color="#66cc66">=</font>&nbsp;a971~matnr</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#993333">AND</font>&nbsp;mara~meins&nbsp;<font color="#66cc66">=</font>&nbsp;a971~vrkme</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LEFT&nbsp;JOIN&nbsp;konp</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#993333">ON</font>&nbsp;konp~knumh&nbsp;EQ&nbsp;a971~knumh</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#993333">WHERE</font>&nbsp;a971~kappl&nbsp;EQ&nbsp;<font color="#ff0000">'V'</font>&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#993333">AND</font>&nbsp;a971~kschl&nbsp;<font color="#993333">IN</font>&nbsp;lr_kschl</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#993333">AND</font>&nbsp;a971~vkorg&nbsp;EQ&nbsp;lv_vkorg</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#993333">AND</font>&nbsp;a971~vtweg&nbsp;EQ&nbsp;<font color="#ff0000">'01'</font></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#993333">AND</font>&nbsp;a971~werks&nbsp;EQ&nbsp;i_werks</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#993333">AND</font>&nbsp;a971~datbi&nbsp;GE&nbsp;sy<font color="#66cc66">-</font>datum</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#993333">AND</font>&nbsp;a971~datab&nbsp;LE&nbsp;sy<font color="#66cc66">-</font>datum.</li><li>&nbsp;</li><li>&nbsp;&nbsp;ELSEIF&nbsp;tab<font color="#66cc66">&#91;</font><font color="#66cc66">&#93;</font>&nbsp;<font color="#993333">IS</font>&nbsp;<font color="#993333">NOT</font>&nbsp;<font color="#993333">INITIAL</font>.</li><li>&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;<font color="#993333">SELECT</font>&nbsp;a971~kschl&nbsp;a971~matnr&nbsp;a971~vrkme&nbsp;a971~datbi&nbsp;a971~datab&nbsp;a971~knumh</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;konp~kopos&nbsp;konp~kbetr&nbsp;konp~konwa&nbsp;<font color="#993333">AS</font>&nbsp;waers&nbsp;&nbsp;konp~loevm_ko</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#993333">INTO</font>&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;<font color="#993333">OF</font>&nbsp;<font color="#993333">TABLE</font>&nbsp;lt_rec</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#993333">FROM</font>&nbsp;a971&nbsp;INNER&nbsp;JOIN&nbsp;mara</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#993333">ON</font>&nbsp;mara~matnr&nbsp;<font color="#66cc66">=</font>&nbsp;a971~matnr</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#993333">AND</font>&nbsp;mara~meins&nbsp;<font color="#66cc66">=</font>&nbsp;a971~vrkme</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LEFT&nbsp;JOIN&nbsp;konp</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#993333">ON</font>&nbsp;konp~knumh&nbsp;EQ&nbsp;a971~knumh</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#993333">FOR</font>&nbsp;<font color="#993333">ALL</font>&nbsp;ENTRIES&nbsp;<font color="#993333">IN</font>&nbsp;tab</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#993333">WHERE</font>&nbsp;a971~kappl&nbsp;EQ&nbsp;<font color="#ff0000">'V'</font>&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#993333">AND</font>&nbsp;a971~kschl&nbsp;<font color="#993333">IN</font>&nbsp;lr_kschl</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#993333">AND</font>&nbsp;a971~vkorg&nbsp;EQ&nbsp;lv_vkorg</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#993333">AND</font>&nbsp;a971~vtweg&nbsp;EQ&nbsp;<font color="#ff0000">'01'</font></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#993333">AND</font>&nbsp;a971~werks&nbsp;EQ&nbsp;i_werks</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#993333">AND</font>&nbsp;a971~matnr&nbsp;EQ&nbsp;tab<font color="#66cc66">-</font>matnr</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#993333">AND</font>&nbsp;a971~datbi&nbsp;GE&nbsp;sy<font color="#66cc66">-</font>datum</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#993333">AND</font>&nbsp;a971~datab&nbsp;LE&nbsp;sy<font color="#66cc66">-</font>datum.</li><li>&nbsp;</li><li>&nbsp;&nbsp;ENDIF.</li><li>&nbsp;&nbsp;<font color="#993333">DELETE</font>&nbsp;lt_rec&nbsp;<font color="#993333">WHERE</font>&nbsp;&nbsp;loevm_ko&nbsp;EQ&nbsp;<font color="#ff0000">'X'</font>.</li><li>&nbsp;&nbsp;<font color="#993333">IF</font>&nbsp;lt_rec&nbsp;<font color="#993333">IS</font>&nbsp;<font color="#993333">INITIAL</font>.</li><li>&nbsp;&nbsp;&nbsp;&nbsp;<font color="#993333">RAISE</font>&nbsp;no_data.</li><li>&nbsp;&nbsp;ENDIF.</li><li>&nbsp;&nbsp;ls_rec<font color="#66cc66">-</font>sort_order&nbsp;<font color="#66cc66">=</font>&nbsp;<font color="#cc66cc">1</font>.</li><li>&nbsp;&nbsp;<font color="#993333">MODIFY</font>&nbsp;lt_rec&nbsp;<font color="#993333">FROM</font>&nbsp;ls_rec&nbsp;TRANSPORTING&nbsp;sort_order&nbsp;<font color="#993333">WHERE</font>&nbsp;kschl&nbsp;EQ&nbsp;ycl_common<font color="#66cc66">=&gt;</font>c_vka0.</li><li>&nbsp;&nbsp;ls_rec<font color="#66cc66">-</font>sort_order&nbsp;<font color="#66cc66">=</font>&nbsp;<font color="#cc66cc">2</font>.</li><li>&nbsp;&nbsp;<font color="#993333">MODIFY</font>&nbsp;lt_rec&nbsp;<font color="#993333">FROM</font>&nbsp;ls_rec&nbsp;TRANSPORTING&nbsp;sort_order&nbsp;<font color="#993333">WHERE</font>&nbsp;kschl&nbsp;EQ&nbsp;ycl_common<font color="#66cc66">=&gt;</font>c_yvk3.</li><li>&nbsp;&nbsp;ls_rec<font color="#66cc66">-</font>sort_order&nbsp;<font color="#66cc66">=</font>&nbsp;<font color="#cc66cc">3</font>.</li><li>&nbsp;&nbsp;<font color="#993333">MODIFY</font>&nbsp;lt_rec&nbsp;<font color="#993333">FROM</font>&nbsp;ls_rec&nbsp;TRANSPORTING&nbsp;sort_order&nbsp;<font color="#993333">WHERE</font>&nbsp;kschl&nbsp;EQ&nbsp;ycl_common<font color="#66cc66">=&gt;</font>c_vkp0.</li><li>&nbsp;&nbsp;SORT&nbsp;lt_rec&nbsp;<font color="#993333">BY</font>&nbsp;matnr&nbsp;ASCENDING</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sort_order&nbsp;ASCENDING</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;kopos&nbsp;ASCENDING.</li><li>&nbsp;&nbsp;FIELD<font color="#66cc66">-</font>SYMBOLS:&nbsp;<font color="#66cc66">&lt;</font>fs_rec<font color="#66cc66">&gt;</font>&nbsp;<font color="#993333">TYPE</font>&nbsp;t_line<font color="#66cc66">,</font></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#66cc66">&lt;</font>fs_line<font color="#66cc66">&gt;</font>&nbsp;<font color="#993333">TYPE</font>&nbsp;ysout_price.</li><li>&nbsp;&nbsp;DATA:&nbsp;lv_find&nbsp;<font color="#993333">TYPE</font>&nbsp;flag.</li><li>&nbsp;&nbsp;CLEAR&nbsp;lv_find.</li><li>&nbsp;&nbsp;CLEAR&nbsp;tab<font color="#66cc66">&#91;</font><font color="#66cc66">&#93;</font>.</li><li>&nbsp;&nbsp;<font color="#993333">LOOP</font>&nbsp;<font color="#993333">AT</font>&nbsp;lt_rec&nbsp;ASSIGNING&nbsp;<font color="#66cc66">&lt;</font>fs_rec<font color="#66cc66">&gt;</font>.</li><li>&nbsp;&nbsp;&nbsp;&nbsp;<font color="#993333">AT</font>&nbsp;<font color="#993333">NEW</font>&nbsp;matnr.</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;lv_find.</li><li>&nbsp;&nbsp;&nbsp;&nbsp;ENDAT.</li><li>&nbsp;&nbsp;&nbsp;&nbsp;<font color="#993333">CHECK</font>&nbsp;lv_find&nbsp;NE&nbsp;<font color="#ff0000">'X'</font>.</li><li>&nbsp;&nbsp;&nbsp;&nbsp;<font color="#993333">IF</font>&nbsp;<font color="#66cc66">&lt;</font>fs_rec<font color="#66cc66">&gt;-</font>kbetr&nbsp;<font color="#66cc66">&gt;</font>&nbsp;<font color="#cc66cc">0</font>.</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;<font color="#993333">INITIAL</font>&nbsp;LINE&nbsp;<font color="#993333">TO</font>&nbsp;tab&nbsp;ASSIGNING&nbsp;<font color="#66cc66">&lt;</font>fs_line<font color="#66cc66">&gt;</font>.</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#993333">CHECK</font>&nbsp;<font color="#66cc66">&lt;</font>fs_line<font color="#66cc66">&gt;</font>&nbsp;<font color="#993333">IS</font>&nbsp;ASSIGNED.</li><li>&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#993333">CALL</font>&nbsp;<font color="#993333">FUNCTION</font>&nbsp;<font color="#ff0000">'BAPI_CURRENCY_CONV_TO_EXTERNAL'</font></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;currency&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#66cc66">=</font>&nbsp;<font color="#66cc66">&lt;</font>fs_rec<font color="#66cc66">&gt;-</font>waers</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;amount_internal&nbsp;<font color="#66cc66">=</font>&nbsp;<font color="#66cc66">&lt;</font>fs_rec<font color="#66cc66">&gt;-</font>kbetr</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;amount_external&nbsp;<font color="#66cc66">=</font>&nbsp;<font color="#66cc66">&lt;</font>fs_line<font color="#66cc66">&gt;-</font>kbetr.</li><li>&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#993333">CALL</font>&nbsp;<font color="#993333">FUNCTION</font>&nbsp;<font color="#ff0000">'CONVERSION_EXIT_ALPHA_OUTPUT'</font></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;input&nbsp;&nbsp;<font color="#66cc66">=</font>&nbsp;<font color="#66cc66">&lt;</font>fs_rec<font color="#66cc66">&gt;-</font>matnr</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;output&nbsp;<font color="#66cc66">=</font>&nbsp;<font color="#66cc66">&lt;</font>fs_line<font color="#66cc66">&gt;-</font>matnr.</li><li>&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#66cc66">&lt;</font>fs_line<font color="#66cc66">&gt;-</font>kschl&nbsp;<font color="#66cc66">=</font>&nbsp;<font color="#66cc66">&lt;</font>fs_rec<font color="#66cc66">&gt;-</font>kschl.</li><li>&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#993333">CALL</font>&nbsp;<font color="#993333">FUNCTION</font>&nbsp;<font color="#ff0000">'WLK1_CHECK'</font></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#993333">DATE</font>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#66cc66">=</font>&nbsp;sy<font color="#66cc66">-</font>datum</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;item&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#66cc66">=</font>&nbsp;<font color="#66cc66">&lt;</font>fs_rec<font color="#66cc66">&gt;-</font>matnr</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;shop_werks&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#66cc66">=</font>&nbsp;i_werks</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;component_check&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#66cc66">=</font>&nbsp;<font color="#ff0000">'X'</font></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;no_listing&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#66cc66">=</font>&nbsp;<font color="#cc66cc">1</font></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;no_listing_in_time&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#66cc66">=</font>&nbsp;<font color="#cc66cc">2</font></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;existing_exclusion_listing&nbsp;&nbsp;<font color="#66cc66">=</font>&nbsp;<font color="#cc66cc">3</font></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;wrong_parameters&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#66cc66">=</font>&nbsp;<font color="#cc66cc">4</font></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;no_open_time_shop_in_time&nbsp;&nbsp;&nbsp;<font color="#66cc66">=</font>&nbsp;<font color="#cc66cc">5</font></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;no_listing_for_promotion&nbsp;&nbsp;&nbsp;&nbsp;<font color="#66cc66">=</font>&nbsp;<font color="#cc66cc">6</font></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;wrong_location&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#66cc66">=</font>&nbsp;<font color="#cc66cc">7</font></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;no_complete_listing_in_time&nbsp;<font color="#66cc66">=</font>&nbsp;<font color="#cc66cc">8</font></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;wrong_rackjobber&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#66cc66">=</font>&nbsp;<font color="#cc66cc">9</font></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;listing_only_as_component&nbsp;&nbsp;&nbsp;<font color="#66cc66">=</font>&nbsp;<font color="#cc66cc">10</font></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;no_assignment&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#66cc66">=</font>&nbsp;<font color="#cc66cc">11</font></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#993333">OTHERS</font>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#66cc66">=</font>&nbsp;<font color="#cc66cc">12</font>.</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#993333">IF</font>&nbsp;sy<font color="#66cc66">-</font>subrc&nbsp;EQ&nbsp;<font color="#cc66cc">0</font>.</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#66cc66">&lt;</font>fs_line<font color="#66cc66">&gt;-</font>assort&nbsp;<font color="#66cc66">=</font>&nbsp;<font color="#ff0000">'X'</font>.</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.</li><li>&nbsp;</li><li>&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_find&nbsp;<font color="#66cc66">=</font>&nbsp;<font color="#ff0000">'X'</font>.</li><li>&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.</li><li>&nbsp;</li><li>&nbsp;&nbsp;ENDLOOP.</li><li>ENDFUNCTION.</li></ol></blockquote>

            <p>Функционал SAP Connector for Microsoft .NET и C# позволяет получать данные простым и удобным способом из SAP ERP. </p>
          </div>

          <div class="col-lg-12">
            <p>
            <div id="disqus_thread"></div>
            <script>

            /**
            *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
            *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
            /*
            var disqus_config = function () {
            this.page.url = 'http://www.predictgroup.com/pricechecker_sap.html';  
            this.page.identifier = PRICE_CHECKER_SAP; 
            };
            */
            (function() { // DON'T EDIT BELOW THIS LINE
            var d = document, s = d.createElement('script');
            s.src = 'https://predictgroup-com.disqus.com/embed.js';
            s.setAttribute('data-timestamp', +new Date());
            (d.head || d.body).appendChild(s);
            })();
            </script>
            <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
            </p>
          </div>

	    </div>

	  </div>
        <!--  -->
      <div class="bs-docs-section">

<!--
        <div class="row">
          <div class="col-lg-12">
            <div>
              <ul class="pagination">
                <li class="page-item disabled">
                  <a class="page-link" href="#">&laquo;</a>
                </li>
                <li class="page-item active">
                  <a class="page-link" href="#">1</a>
                </li>
                <li class="page-item">
                  <a class="page-link" href="#">2</a>
                </li>
                <li class="page-item">
                  <a class="page-link" href="#">3</a>
                </li>
                <li class="page-item">
                  <a class="page-link" href="#">4</a>
                </li>
                <li class="page-item">
                  <a class="page-link" href="#">5</a>
                </li>
                <li class="page-item">
                  <a class="page-link" href="#">&raquo;</a>
                </li>
              </ul>
            </div>
          </div>
        </div>
-->

	  </div>

      <footer id="footer">
        <div class="row">
          <div class="col-lg-12">

            <ul class="list-unstyled">
              <li class="float-lg-right"><a href="#top">Вернуться наверх</a></li>
              <li><a href="https://twitter.com/predictgroup">Twitter</a></li>
              <li><a href="https://github.com/predictgroup/">GitHub</a></li>
            </ul>
            <p>Авторские права &copy; <a href="copyrights.html">ПредиктГруп</a> 2019.</p>
            <p>Based on <a href="http://getbootstrap.com" rel="nofollow">Bootstrap</a>. Icons from <a href="http://fontawesome.io/" rel="nofollow">Font Awesome</a>. Web fonts from <a href="https://fonts.google.com/" rel="nofollow">Google</a>.</p>

          </div>
        </div>

      </footer>


    </div>


    <script src="vendor/jquery/dist/jquery.min.js"></script>
    <script src="vendor/popper.js/dist/umd/popper.min.js"></script>
    <script src="vendor/bootstrap/dist/js/bootstrap.min.js"></script>
  </body>
</html>
